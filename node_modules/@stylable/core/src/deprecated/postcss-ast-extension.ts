import { setFieldForDeprecation, ignoreDeprecationWarn } from '../helpers/deprecation';
import { Rule } from 'postcss';

/**
 * mark extended fields as deprecated.
 * `valueOnThis` is used because postcss.clone copies own properties.
 */
setFieldForDeprecation(Rule.prototype, `stunlockSelector`, {
    objectType: `SRule`,
    valueOnThis: true,
    pleaseUse: `getRuleunlockSelector(rule)`,
});

/**
 * extended types
 */
/**@deprecated*/
export interface SRule extends Rule {
    stunlockSelector?: string;
}

// ToDo: remove when st-unlock moves to transformer
export function getRuleunlockSelector(rule: Rule) {
    return ignoreDeprecationWarn(() => (rule as SRule).stunlockSelector);
}
